function handleClientLoad(){gapi.client.setApiKey(apiKey),window.setTimeout(checkAuth,1)}function checkAuth(){gapi.auth.authorize({client_id:clientId,scope:scopes,immediate:!0},handleAuthResult)}function change(a,b){var c=angular.element($("#controllerTag")).scope();c.$apply(function(){c[a]=b})}function handleAuthResult(a){var b=document.getElementById("authorize-button");a&&!a.error?(b.style.visibility="hidden",change("googleApi","lalalalalla"),makeApiCall()):(b.style.visibility="",b.onclick=handleAuthClick)}function handleAuthClick(){return gapi.auth.authorize({client_id:clientId,scope:scopes,immediate:!1},handleAuthResult),!1}function makeApiCall(){gapi.client.load("gmail","v1",function(){var a=gapi.client.gmail.users.getProfile({userId:"me"});a.execute(function(a){var b=document.getElementById("logInfo");b.innerHTML="Welcome, "+a.emailAddress+"<br/>"});var b=gapi.client.gmail.users.labels.list({userId:"me"});b.execute(function(a){var b=a.labels;showLabels(b)});var c=gapi.client.gmail.users.messages.list({userId:"me"});c.execute(function(a){a.messages.forEach(function(a){var b=document.createElement("div");b.className="messageDiv";var c=document.createElement("div");c.className="headerDiv";var d=document.createElement("p");d.className="snippetDiv";var e=document.createElement("p"),f=document.createElement("p"),g=gapi.client.gmail.users.messages.get({userId:"me",id:a.id});g.execute(function(a){if(null==a.payload)console.log("payload null");else{a.payload.headers.forEach(function(a){"Subject"==a.name&&(f.innerHTML+="<label>Subject:</label> "+a.value)}),a.payload.headers.forEach(function(a){"From"==a.name&&(e.innerHTML+="<label>From:</label> "+a.value)});var b;a.snippet?(b=a.snippet,d.innerHTML+=b+"..."):d.innerHTML+="This message has no content"}}),b.appendChild(c),b.appendChild(d),c.appendChild(e),c.appendChild(f),document.getElementById("content").appendChild(b)})})})}function showLabels(a){a.forEach(function(a){if("user"==a.type){var b=document.createElement("span");b.className="labelDiv",b.innerHTML+=a.name,document.getElementById("labelContainer").appendChild(b)}}),a.forEach(function(a){if("INBOX"==a.id){var b=document.createElement("div");b.className="labelDivINBOX",b.innerHTML+="Show all messages in inbox",document.getElementById("labelContainer").appendChild(b)}})}!function(a){"use strict";var b,c=a.Base64,d="2.1.7";"undefined"!=typeof module&&module.exports&&(b=require("buffer").Buffer);var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",f=function(a){for(var b={},c=0,d=a.length;d>c;c++)b[a.charAt(c)]=c;return b}(e),g=String.fromCharCode,h=function(a){if(a.length<2){var b=a.charCodeAt(0);return 128>b?a:2048>b?g(192|b>>>6)+g(128|63&b):g(224|b>>>12&15)+g(128|b>>>6&63)+g(128|63&b)}var b=65536+1024*(a.charCodeAt(0)-55296)+(a.charCodeAt(1)-56320);return g(240|b>>>18&7)+g(128|b>>>12&63)+g(128|b>>>6&63)+g(128|63&b)},i=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,j=function(a){return a.replace(i,h)},k=function(a){var b=[0,2,1][a.length%3],c=a.charCodeAt(0)<<16|(a.length>1?a.charCodeAt(1):0)<<8|(a.length>2?a.charCodeAt(2):0),d=[e.charAt(c>>>18),e.charAt(c>>>12&63),b>=2?"=":e.charAt(c>>>6&63),b>=1?"=":e.charAt(63&c)];return d.join("")},l=a.btoa?function(b){return a.btoa(b)}:function(a){return a.replace(/[\s\S]{1,3}/g,k)},m=b?function(a){return(a.constructor===b.constructor?a:new b(a)).toString("base64")}:function(a){return l(j(a))},n=function(a,b){return b?m(String(a)).replace(/[+\/]/g,function(a){return"+"==a?"-":"_"}).replace(/=/g,""):m(String(a))},o=function(a){return n(a,!0)},p=new RegExp(["[À-ß][-¿]","[à-ï][-¿]{2}","[ð-÷][-¿]{3}"].join("|"),"g"),q=function(a){switch(a.length){case 4:var b=(7&a.charCodeAt(0))<<18|(63&a.charCodeAt(1))<<12|(63&a.charCodeAt(2))<<6|63&a.charCodeAt(3),c=b-65536;return g((c>>>10)+55296)+g((1023&c)+56320);case 3:return g((15&a.charCodeAt(0))<<12|(63&a.charCodeAt(1))<<6|63&a.charCodeAt(2));default:return g((31&a.charCodeAt(0))<<6|63&a.charCodeAt(1))}},r=function(a){return a.replace(p,q)},s=function(a){var b=a.length,c=b%4,d=(b>0?f[a.charAt(0)]<<18:0)|(b>1?f[a.charAt(1)]<<12:0)|(b>2?f[a.charAt(2)]<<6:0)|(b>3?f[a.charAt(3)]:0),e=[g(d>>>16),g(d>>>8&255),g(255&d)];return e.length-=[0,0,2,1][c],e.join("")},t=a.atob?function(b){return a.atob(b)}:function(a){return a.replace(/[\s\S]{1,4}/g,s)},u=b?function(a){return(a.constructor===b.constructor?a:new b(a,"base64")).toString()}:function(a){return r(t(a))},v=function(a){return u(String(a).replace(/[-_]/g,function(a){return"-"==a?"+":"/"}).replace(/[^A-Za-z0-9\+\/]/g,""))},w=function(){var b=a.Base64;return a.Base64=c,b};if(a.Base64={VERSION:d,atob:t,btoa:l,fromBase64:v,toBase64:n,utob:j,encode:n,encodeURI:o,btou:r,decode:v,noConflict:w},"function"==typeof Object.defineProperty){var x=function(a){return{value:a,enumerable:!1,writable:!0,configurable:!0}};a.Base64.extendString=function(){Object.defineProperty(String.prototype,"fromBase64",x(function(){return v(this)})),Object.defineProperty(String.prototype,"toBase64",x(function(a){return n(this,a)})),Object.defineProperty(String.prototype,"toBase64URI",x(function(){return n(this,!0)}))}}}(this),this.Meteor&&(Base64=global.Base64);var clientId="130554426228-5n2t4fcm2k9g977mvodfh9vo9591u69t.apps.googleusercontent.com",apiKey="AIzaSyCeE7WUuVzyOQUlQuRuSZ5O_h_cw4MLn2k",scopes="https://www.googleapis.com/auth/gmail.readonly";