<div data-ng-repeat="thread in userSpace.threads"> 

    <div class="emailThreadBody" id="{{'emailThreadBody_'+userSpace.space.uniqId+'_'+$index}}">
        <div data-ng-repeat="message in thread.messages track by $index" ng-class="message.messageStatus == 'UNREAD' ? 'unreadThread' : ''" id="{{'emailMessage_'+thread.lastMsg.msg.threadId+'_'+$index}}">
            <div  class="emailBody row">
                <div class="col-md-1">
                    <img ng-src="{{findProfile('sm','50', message.msg.from)}}" class="profileInsideMsg">
                </div>
                <div class="col-md-11 emailBodyContent">
                    <span id="senderSpan">&nbsp;{{findName(message.msg.from)}}</span>
                     <span class="btn-group">
                        <button class="logInfoDropdown" data-toggle="dropdown" aria-expanded="true">
                        <span class="caret"></span>
                        </button>
                      <ul class="dropdown-menu dropdown-menu-left" role="menu">
                        <li><a href="#"><b>{{findName(message.msg.from)}}</b>&nbsp;{{'<'+message.msg.from+'>'}}</a></li>
                        <li><a href="#">to</a></li>
                        <li><a href="#"><b>{{findName(message.msg.to)}}</b>&nbsp;{{'<'+message.msg.to+'>'}}</a></li>
                      </ul>
                    </span> 
                    <span class="btn-group" style="float:right;">
                        <button class="logInfoDropdown" data-toggle="dropdown" aria-expanded="true">
                        <span id="replyBtn" class="glyphicon glyphicon-option-vertical"></span>
                        </button>
                      <ul class="dropdown-menu dropdown-menu-right" role="menu">
                        <li><a href="#" ng-click="messageHeaderOnClick(thread.lastMsg.msg.threadId,$index,message)">Reply</a></li>
                      </ul>
                    </span> 
                    
                    <span class="btn-group" style="float:right">
                        <button class="logInfoDropdown" data-toggle="dropdown" aria-expanded="true">
                        <span ng-if="message.attachments.length" class="glyphicon glyphicon-paperclip"></span>&nbsp;&nbsp;
                        {{message.date}}&nbsp;&nbsp;
                        </button>
                    </span>
                    <br>
                    <br>
                    <div ng-bind-html="message.body | sanitize"></div>
    <!--                <span id="snippetSpan">{{message.snippet}}</span><br>-->
                    <div ng-if="message.attachments.length">
                        <hr>
                        Attachments:<br>
                        <div data-ng-repeat="attch in message.attachments track by $index">
                        {{attch}}
                        </div>
                    </div>
                    <div class="replyDiv" id="{{'emailBody_'+thread.lastMsg.msg.threadId+'_'+$index}}">
                        To {{message.msg.from}}<br>
                        <textarea id='replyText{{$index}}' placeholder="Reply"></textarea>
                        <form class="form-horizontal">
                            <div class="form-group">
                                <div class="col-md-1"><button type="submit" class="btn btn-primary" ng-click="replyMsg(thread,$index,userSpace.space.name)">Send</button></div>
                                <div class="col-md-10"><button type="submit" class="btn btn-default glyphicon glyphicon-paperclip iconBtn"></button></div>
                            </div>
                        </form>
                    </div>
                </div>
                    
                
                <!--<span id="dateSpan">
                    <span ng-if="message.attachments.length" class="glyphicon glyphicon-paperclip"></span>&nbsp;&nbsp;
                    {{message.date}}&nbsp;&nbsp;
                    <span id="replyBtn" class="glyphicon glyphicon-share-alt" ng-click="messageHeaderOnClick(thread.lastMsg.msg.threadId,$index,message)"></span>
                </span>-->
                
                
            </div>
         </div>
    </div>
</div>